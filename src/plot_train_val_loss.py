import matplotlib.pyplot as plt
from deploy_model import model
from torchsummary import summary

train_loss = [0.7566635608673096, 0.20984520018100739, 0.17368009686470032, 0.20107877254486084, 0.12552618980407715, 0.13609488308429718, 0.11830885708332062, 0.1424773633480072, 0.12750045955181122, 0.11124672740697861, 0.12564489245414734, 0.1530357003211975, 0.10459492355585098, 0.12362358719110489, 0.11712833493947983, 0.13484907150268555, 0.11013644188642502, 0.13425874710083008, 0.12732990086078644, 0.12355311214923859, 0.1303989738225937, 0.1165352612733841, 0.10537941753864288, 0.12671490013599396, 0.10306011885404587, 0.11541959643363953, 0.12087415158748627, 0.14306576550006866, 0.09420908242464066, 0.089594267308712, 0.12083972990512848, 0.12493563443422318, 0.1118316799402237, 0.1197529137134552, 0.13987886905670166, 0.11524692177772522, 0.1434040069580078, 0.12159361690282822, 0.11399010568857193, 0.09548727422952652, 0.12954147160053253, 0.1348627209663391, 0.11975733190774918, 0.12576334178447723, 0.11015672236680984, 0.11124665290117264, 0.10978967696428299, 0.1398947685956955, 0.1390107274055481, 0.11622805893421173, 0.1077423095703125, 0.10121384263038635, 0.11915256083011627, 0.10232719779014587, 0.10125988721847534, 0.1273421198129654, 0.10411833226680756, 0.1270180493593216, 0.14488662779331207, 0.12777873873710632, 0.09902110695838928, 0.12181342393159866, 0.11560580879449844, 0.10664498060941696, 0.10942249000072479, 0.12289071083068848, 0.08421210944652557, 0.10170198976993561, 0.13541604578495026, 0.11900629848241806]
val_loss = [0.7359040943197549, 0.1961598352740367, 0.1406332267025789, 0.11780125519242911, 0.09995670461902223, 0.08676937028480033, 0.10570832294301864, 0.07865847124697302, 0.08669411404111896, 0.09105649586921682, 0.06952259872858517, 0.07397296143987309, 0.07419723046187776, 0.06859161769048855, 0.07101631464478307, 0.06765241926898971, 0.06372662149250698, 0.059693523417836944, 0.0689837497572739, 0.06821736835014706, 0.06390009294397915, 0.06514449418781283, 0.0595017685986365, 0.06598298089763227, 0.06495288490487364, 0.0728932411406939, 0.07496770499898983, 0.049056200501018055, 0.05715206795083448, 0.05681424355878236, 0.06331528791080648, 0.06143252202830376, 0.06393473059795916, 0.060211772997729694, 0.0520124655252638, 0.06851745841983027, 0.061584687330566656, 0.06272274465225756, 0.05939218886315632, 0.06526434070433672, 0.06000002511678793, 0.05270047571521978, 0.053031533902969226, 0.058620852355758986, 0.05484891431733442, 0.054172022214617595, 0.06437886318269248, 0.04923107935645329, 0.055752169186124405, 0.0517965583160472, 0.04661861968973574, 0.05292310171757643, 0.05347536951779557, 0.05089666489690257, 0.05130621411215764, 0.05318529259996673, 0.05930643554884024, 0.055326686213953424, 0.05413009683354594, 0.06054652059754244, 0.050079757234635064, 0.05305391642898797, 0.059836666804913896, 0.07461544121511447, 0.05239372355298112, 0.05182513456565503, 0.06625341952513582, 0.05294238042812378, 0.04864787681105609, 0.05090790149122001]

plt.title("Train/Val Loss over training period")
plt.plot(train_loss)
plt.plot(val_loss)
plt.legend(["train", "val"])
plt.xlabel("Training iteration")
plt.ylabel("Custom loss (angle between predicted and expected, in rad)")

plt.show()

summary(model, (6, ))

